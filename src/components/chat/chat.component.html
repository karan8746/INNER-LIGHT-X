<header class="flex items-center justify-between p-4 border-b border-purple-500/20">
  <div class="flex items-center space-x-3">
    <div class="relative">
        <div class="absolute -inset-0.5 bg-gradient-to-r from-purple-600 to-amber-500 rounded-full blur-sm opacity-75"></div>
        <div class="relative w-10 h-10 bg-black rounded-full flex items-center justify-center">
        <svg class="w-8 h-8 text-amber-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5-2.5-6.5s-7 1.5-6 6c.5 2.5 2.5 4.5 5 5.5s5.5 1.5 7.5 0c2.5-.5 4-2.5 4-5 .5-2.5-2-3-2-3" /></svg>
        </div>
    </div>
    <div>
      <h2 class="font-orbitron text-lg text-white">Luma X</h2>
      <p class="text-xs text-green-400">Online</p>
    </div>
  </div>
  <button (click)="viewResources.emit()" title="View Resources" class="p-2 rounded-full transition-colors hover:bg-purple-500/20">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16m-7 6h7" />
    </svg>
  </button>
</header>

<main #chatContainer class="flex-1 overflow-y-auto p-4 space-y-4">
  @for (message of messages(); track $index) {
    @if (message.author === 'ai') {
      <div class="flex items-start gap-3">
        <div class="w-8 h-8 rounded-full flex-shrink-0 bg-gradient-to-br from-purple-600 to-amber-400 flex items-center justify-center text-lg">✨</div>
        <div class="bg-gray-800 rounded-lg p-3 max-w-xs md:max-w-md text-gray-300 shadow-md">
          <p class="whitespace-pre-wrap">{{ message.content }}</p>
        </div>
      </div>
    }
    @if (message.author === 'user') {
      <div class="flex items-start gap-3 justify-end">
        <div class="bg-purple-600 rounded-lg p-3 max-w-xs md:max-w-md text-white shadow-md">
           <p class="whitespace-pre-wrap">{{ message.content }}</p>
        </div>
      </div>
    }
    @if (message.author === 'system') {
      <div class="text-center my-4">
        <div class="inline-block bg-yellow-900/50 border border-yellow-500/50 text-yellow-200 rounded-lg p-3 text-sm">
          <p class="font-bold mb-1">Important Resources</p>
          <p>{{ message.content }}</p>
        </div>
      </div>
    }
  }

  @if (isLoading()) {
    <div class="flex items-start gap-3">
        <div class="w-8 h-8 rounded-full flex-shrink-0 bg-gradient-to-br from-purple-600 to-amber-400 flex items-center justify-center text-lg">✨</div>
        <div class="bg-gray-800 rounded-lg p-3 max-w-xs md:max-w-md text-gray-300 shadow-md">
          <div class="flex space-x-1">
            <div class="ai-typing-dot"></div>
            <div class="ai-typing-dot"></div>
            <div class="ai-typing-dot"></div>
          </div>
        </div>
      </div>
  }
</main>

<footer class="p-4 border-t border-purple-500/20">
  <form (submit)="sendMessage()" class="flex items-center space-x-2">
    <button type="button" class="p-2 rounded-full transition-colors hover:bg-purple-500/20">
       <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-300" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M9 2m0 3a3 3 0 0 1 3 -3h0a3 3 0 0 1 3 3v5a3 3 0 0 1 -3 3h0a3 3 0 0 1 -3 -3z"></path>
          <path d="M5 10a7 7 0 0 0 14 0"></path>
          <path d="M8 21l8 0"></path>
          <path d="M12 17l0 4"></path>
       </svg>
    </button>
    <input 
      [(ngModel)]="userInput" 
      name="userInput"
      type="text" 
      placeholder="Type your message..." 
      class="flex-1 w-full bg-gray-900/80 px-4 py-2 rounded-full border border-purple-500/30 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent text-gray-200 placeholder-gray-500"
      autocomplete="off">
    <button 
      type="submit" 
      [disabled]="!userInput().trim() || isLoading()"
      class="p-2 rounded-full bg-purple-600 text-white disabled:bg-gray-600 transition-all transform hover:scale-110 disabled:scale-100">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M10 14l11 -11"></path>
        <path d="M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5"></path>
     </svg>
    </button>
  </form>
</footer>